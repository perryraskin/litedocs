# Migration `20201105171644-teams`

This migration has been generated by Perry Raskin at 11/5/2020, 12:16:44 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Entry" ADD COLUMN "teamId" integer   

CREATE TABLE "public"."Team" (
"id" SERIAL,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"name" text   NOT NULL ,
"handle" text   NOT NULL ,
"imageUrl" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Member" (
"id" SERIAL,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"teamId" integer   ,
"userId" integer   ,
"memberType" integer   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "Team.handle_unique" ON "public"."Team"("handle")

ALTER TABLE "public"."Member" ADD FOREIGN KEY("teamId")REFERENCES "public"."Team"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Member" ADD FOREIGN KEY("userId")REFERENCES "public"."User"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Entry" ADD FOREIGN KEY("teamId")REFERENCES "public"."Team"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201103024311-magic-auth..20201105171644-teams
--- datamodel.dml
+++ datamodel.dml
@@ -2,39 +2,63 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
 }
 model User {
-  id        Int        @id @default(autoincrement())
-  createdAt DateTime   @default(now())
-  name      String
-  email     String
-  issuer    String     @unique
+  id          Int      @id @default(autoincrement())
+  createdAt   DateTime @default(now())
+  name        String
+  email       String
+  issuer      String   @unique
+  Entries     Entry[]
+  Memberships Member[]
 }
 model Entry {
-  id          Int        @id @default(autoincrement())
-  createdAt   DateTime   @default(now())
+  id          Int      @id @default(autoincrement())
+  createdAt   DateTime @default(now())
   userId      Int?
+  teamId      Int?
   title       String
   tagsText    String
   body        String
   code        String
   Tags        Tag[]
-  User        User?      @relation(fields: [userId], references: [id])
-  dateUpdated DateTime   @default(now())
+  Author      User?    @relation(fields: [userId], references: [id])
+  Team        Team?    @relation(fields: [teamId], references: [id])
+  dateUpdated DateTime @default(now())
 }
 model Tag {
-  id        Int        @id @default(autoincrement())
-  createdAt DateTime   @default(now())
+  id        Int      @id @default(autoincrement())
+  createdAt DateTime @default(now())
   entryId   Int?
   name      String
-  Entry     Entry?     @relation(fields: [entryId], references: [id])
-}
+  Entry     Entry?   @relation(fields: [entryId], references: [id])
+}
+
+model Team {
+  id        Int      @id @default(autoincrement())
+  createdAt DateTime @default(now())
+  name      String
+  handle    String   @unique
+  imageUrl  String
+  Members   Member[]
+  Entries   Entry[]
+}
+
+model Member {
+  id         Int      @id @default(autoincrement())
+  createdAt  DateTime @default(now())
+  teamId     Int?
+  userId     Int?
+  memberType Int
+  Team       Team?    @relation(fields: [teamId], references: [id])
+  User       User?    @relation(fields: [userId], references: [id])
+}
```


